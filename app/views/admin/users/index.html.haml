- title t('page_titles.manage_users')

.rightwrapper
  %h2= t('headers.manage_users')

  = link_to "Add new user", new_admin_user_path, { :class => "btn btn-primary"}
  %h3= t("headers.program_managers")
  %table{ :"data-reactivate" => "#{@reactivate}", :"data-suspend" => "#{@suspend}", :"data-suspend-confirm" => "#{@managers_suspend_confirm}", :"data-reactivate-confirm" => "#{@managers_reactivate_confirm}", :"data-delete-confirm" => "#{@managers_delete_confirm}" }
    %thead
      %tr
        %th
          %p First Name
        %th
          %p Last Name
        %th
          %p Email
        -#%th Programs
        %th
          %p Last Sign In
        %th{:colspan => "3"}
          %p Manage
    %tbody
      - @program_managers.each do |pm|
      - pm.active_for_authentication ? link = @suspend : link = @reactivate
        %tr{:class => pm.active_for_authentication ? '' : 'suspended' }
          %td
            %p= link_to pm.first_name, admin_user_path(pm)
          %td
            %p= link_to pm.last_name, admin_user_path(pm)
          %td
            %p= link_to pm.email, admin_user_path(pm)
          -#%td
            %ul
            - pm.programs.each do |p|
              %li= p.name

          %td
            - unless pm.last_sign_in_at.nil?
              %p= l pm.last_sign_in_at, format: :sign_ins
          %td
            %p= link_to t("links.edit"), edit_admin_user_path(pm)
          %td
            %p= link_to link, "#", { class: "toggle-user", :"data-id" => "#{pm.id}", :"data-reactivate" => "#{@reactivate}", :"data-suspend" => "#{@suspend}", :"data-suspend-confirm" => "#{@managers_suspend_confirm}", remote: true }
          %td
            %p= link_to t("links.delete"), "#", { class: "delete-row", :"data-path" => "/admin/users/#{pm.id}", :"data-id" => "#{pm.id}", remote: true }

  %h3= t("headers.students")
  %table{ :"data-reactivate" => "#{@reactivate}", :"data-suspend" => "#{@suspend}", :"data-suspend-confirm" => "#{@users_suspend_confirm}", :"data-reactivate-confirm" => "#{@users_reactivate_confirm}", :"data-delete-confirm" => "#{@users_delete_confirm}" }
    %thead
      %tr
        %th First Name
        %th Last Name
        %th Email
        %th Programs
        %th Mobile Phone
        %th School
        %th Last Sign In
        %th{:colspan => "3"} Manage
    %tbody
      - @students.each do |u|
      - u.active_for_authentication ? link = @suspend : link = @reactivate
        %tr{:class => u.active_for_authentication ? '' : 'suspended' }
          %td= link_to u.first_name, admin_user_path(u)
          %td= link_to u.last_name, admin_user_path(u)
          %td= link_to u.email, admin_user_path(u)
          %td
            %ul
              - u.programs.each do |p|
                %li= p.name
          %td= link_to (u.mobile_phone.nil? ? '' : u.mobile_phone), admin_user_path(u)
          %td= u.school.name unless u.school.nil?
          %td= u.last_sign_in_at
          %td= link_to t("links.edit"), edit_admin_user_path(u)
          %td= link_to link, "#", { class: "toggle-user", :"data-id" => "#{u.id}", remote: true }
          %td= link_to t("links.delete"), "#", { class: "delete-row", :"data-path" => "/admin/users/#{u.id}", :"data-id" => "#{u.id}", remote: true }

  = paginate @students
